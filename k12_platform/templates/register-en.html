{% extends "base-en.html" %}

{% block title %}Register - Smart Education Platform{% endblock %}

{% block body %}
<div style="position: absolute; top: 20px; right: 20px; z-index: 1000;">
    <a href="/register" class="btn btn-ghost btn-sm">
        <i class="fas fa-language"></i>
        ‰∏≠Êñá
    </a>
</div>
<div class="auth-page">
    <div class="auth-left">
        <h1>üöÄ Start Your Learning Journey</h1>
        <p>
            Register as a member<br>
            Unlock all learning features<br>
            Let AI be your personal teacher!
        </p>
        <div class="auth-decorations">
            <div class="auth-decoration">üéØ</div>
            <div class="auth-decoration">üí°</div>
            <div class="auth-decoration">üèÜ</div>
        </div>
    </div>
    
    <div class="auth-right">
        <div class="auth-card">
            <h2>Create Account</h2>
            <p class="subtitle">Fill in your information to start smart learning</p>
            
            <form class="auth-form" id="registerForm">
                <div class="input-group">
                    <label for="username">Username *</label>
                    <input type="text" class="input" id="username" name="username" placeholder="Set a username" required>
                </div>
                
                <div class="input-group">
                    <label for="password">Password *</label>
                    <input type="password" class="input" id="password" name="password" placeholder="Set password (at least 6 characters)" required minlength="6">
                </div>
                
                <div class="input-group">
                    <label for="email">Email</label>
                    <input type="email" class="input" id="email" name="email" placeholder="Optional, for password recovery">
                </div>
                
                <div class="input-group">
                    <label for="grade">Grade</label>
                    <select class="input" id="grade" name="grade">
                        <option value="">Select grade</option>
                        <option value="Â∞èÂ≠¶‰∏ÄÂπ¥Á∫ß">Elementary 1st Grade</option>
                        <option value="Â∞èÂ≠¶‰∫åÂπ¥Á∫ß">Elementary 2nd Grade</option>
                        <option value="Â∞èÂ≠¶‰∏âÂπ¥Á∫ß">Elementary 3rd Grade</option>
                        <option value="Â∞èÂ≠¶ÂõõÂπ¥Á∫ß">Elementary 4th Grade</option>
                        <option value="Â∞èÂ≠¶‰∫îÂπ¥Á∫ß">Elementary 5th Grade</option>
                        <option value="Â∞èÂ≠¶ÂÖ≠Âπ¥Á∫ß">Elementary 6th Grade</option>
                        <option value="Âàù‰∏≠‰∏ÄÂπ¥Á∫ß">Middle School 7th Grade</option>
                        <option value="Âàù‰∏≠‰∫åÂπ¥Á∫ß">Middle School 8th Grade</option>
                        <option value="Âàù‰∏≠‰∏âÂπ¥Á∫ß">Middle School 9th Grade</option>
                        <option value="È´ò‰∏≠‰∏ÄÂπ¥Á∫ß">High School 10th Grade</option>
                        <option value="È´ò‰∏≠‰∫åÂπ¥Á∫ß">High School 11th Grade</option>
                        <option value="È´ò‰∏≠‰∏âÂπ¥Á∫ß">High School 12th Grade</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label>Preferred Subjects</label>
                    <div class="subject-select" id="subjectSelect">
                        <span class="subject-option" data-value="Êï∞Â≠¶">Math</span>
                        <span class="subject-option" data-value="ËØ≠Êñá">Chinese</span>
                        <span class="subject-option" data-value="Ëã±ËØ≠">English</span>
                        <span class="subject-option" data-value="Áâ©ÁêÜ">Physics</span>
                        <span class="subject-option" data-value="ÂåñÂ≠¶">Chemistry</span>
                        <span class="subject-option" data-value="ÁîüÁâ©">Biology</span>
                    </div>
                    <input type="hidden" id="subjects" name="subjects">
                </div>
                
                <button type="submit" class="btn btn-primary btn-lg">
                    <i class="fas fa-user-plus"></i>
                    Register
                </button>
            </form>
            
            <div class="auth-footer">
                Already have an account? <a href="/login-en">Login now</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Subject selection
const subjectOptions = document.querySelectorAll('.subject-option');
const subjectsInput = document.getElementById('subjects');
let selectedSubjects = [];

subjectOptions.forEach(option => {
    option.addEventListener('click', () => {
        const value = option.dataset.value;
        if (option.classList.contains('active')) {
            option.classList.remove('active');
            selectedSubjects = selectedSubjects.filter(s => s !== value);
        } else {
            option.classList.add('active');
            selectedSubjects.push(value);
        }
        subjectsInput.value = selectedSubjects.join(',');
    });
});

// Form submission
document.getElementById('registerForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const formData = new FormData(e.target);
    
    try {
        await api('/api/register', {
            method: 'POST',
            body: formData
        });
        showToast('Registration successful!');
        setTimeout(() => window.location.href = '/en', 500);
    } catch (error) {
        // Error already handled in api function
    }
});
</script>
{% endblock %}
