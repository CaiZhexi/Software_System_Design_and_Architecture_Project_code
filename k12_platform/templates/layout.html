{% extends "base.html" %}

{% block body %}
<!-- å¯¼èˆªæ  -->
<nav class="navbar">
    <div class="container">
        <a href="/" class="navbar-brand">
            <div class="navbar-logo">ğŸ“</div>
            <span class="navbar-title">æ™ºæ…§æ•™è‚²</span>
        </a>
        
        <div class="navbar-nav">
            <a href="/" class="nav-link {% if request.url.path == '/' %}active{% endif %}">
                <i class="fas fa-home icon"></i>
                é¦–é¡µ
            </a>
            <a href="/question" class="nav-link {% if request.url.path == '/question' %}active{% endif %}">
                <i class="fas fa-question-circle icon"></i>
                æ™ºèƒ½é—®ç­”
            </a>
            <a href="/essay" class="nav-link {% if request.url.path == '/essay' %}active{% endif %}">
                <i class="fas fa-pen-fancy icon"></i>
                ä½œæ–‡æ‰¹æ”¹
            </a>
            <a href="/chat" class="nav-link {% if request.url.path == '/chat' %}active{% endif %}">
                <i class="fas fa-comments icon"></i>
                å­¦ä¹ åŠ©æ‰‹
            </a>
        </div>
        
        <div class="navbar-user">
            <a href="#" onclick="switchLanguage('en')" class="btn btn-ghost btn-sm" style="margin-right: var(--spacing-md);">
                <i class="fas fa-language"></i>
                English
            </a>
            <a href="/profile" class="user-avatar">{{ user.username[0] | upper }}</a>
        </div>
    </div>
</nav>

<!-- ä¸»ä½“å¸ƒå±€ -->
<div class="app-layout">
    <!-- ä¾§è¾¹æ  -->
    <aside class="sidebar">
        <nav class="sidebar-nav">
            <a href="/" class="sidebar-link {% if request.url.path == '/' %}active{% endif %}">
                <i class="fas fa-home icon"></i>
                å­¦ä¹ ä¸­å¿ƒ
            </a>
            <a href="/question" class="sidebar-link {% if request.url.path == '/question' %}active{% endif %}">
                <i class="fas fa-camera icon"></i>
                æ‹ç…§è§£é¢˜
            </a>
            <a href="/essay" class="sidebar-link {% if request.url.path == '/essay' %}active{% endif %}">
                <i class="fas fa-pen-fancy icon"></i>
                ä½œæ–‡æ‰¹æ”¹
            </a>
            <a href="/chat" class="sidebar-link {% if request.url.path == '/chat' %}active{% endif %}">
                <i class="fas fa-robot icon"></i>
                èŠå¤©åŠ©æ‰‹
            </a>
            <a href="/wrong-book" class="sidebar-link {% if request.url.path == '/wrong-book' %}active{% endif %}">
                <i class="fas fa-book icon"></i>
                é”™é¢˜æœ¬
            </a>
            <a href="/statistics" class="sidebar-link {% if request.url.path == '/statistics' %}active{% endif %}">
                <i class="fas fa-chart-line icon"></i>
                å­¦ä¹ ç»Ÿè®¡
            </a>
            <a href="/profile" class="sidebar-link {% if request.url.path == '/profile' %}active{% endif %}">
                <i class="fas fa-user icon"></i>
                ä¸ªäººä¸­å¿ƒ
            </a>
            <a href="#" class="sidebar-link" onclick="logout()">
                <i class="fas fa-sign-out-alt icon"></i>
                é€€å‡ºç™»å½•
            </a>
        </nav>
    </aside>
    
    <!-- ä¸»å†…å®¹åŒº -->
    <main class="main-content">
        {% block content %}{% endblock %}
    </main>
</div>

<script>
async function logout() {
    await api('/api/logout', { method: 'POST' });
    window.location.href = '/login';
}

function switchLanguage(lang) {
    const currentPath = window.location.pathname;
    if (lang === 'en') {
        // åˆ‡æ¢åˆ°è‹±æ–‡ç‰ˆ
        if (currentPath === '/') {
            window.location.href = '/en';
        } else if (!currentPath.endsWith('-en')) {
            window.location.href = currentPath + '-en';
        }
    }
}
</script>
{% endblock %}
